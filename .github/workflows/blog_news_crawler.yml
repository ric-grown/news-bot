name: Run Crawler Every Hour

on:
  schedule:
    - cron: '0 * * * *'  # ë§¤ì‹œê°„ 0ë¶„ë§ˆë‹¤ ì‹¤í–‰ (ì˜ˆ: 01:00, 02:00, 03:00 ...)

  workflow_dispatch:  # ìˆ˜ë™ ì‹¤í–‰ ê°€ëŠ¥í•˜ë„ë¡ ì¶”ê°€

jobs:
  crawl:
    runs-on: ubuntu-latest

    steps:
      - name: ì €ì¥ì†Œ ì²´í¬ì•„ì›ƒ (ì½”ë“œ ê°€ì ¸ì˜¤ê¸°)
        uses: actions/checkout@v4

      - name: Python ì„¤ì • (Python 3.9)
        uses: actions/setup-python@v4
        with:
          python-version: '3.9'

      - name: í•„ìš”í•œ íŒ¨í‚¤ì§€ ì„¤ì¹˜
        run: |
          pip install -r requirements.txt

      - name: í¬ë¡¤ëŸ¬ ì‹¤í–‰
        run: |
          python main_crawler.py

      - name: ë³€ê²½ ì‚¬í•­ ì»¤ë°‹ ë° í‘¸ì‹œ
        env:
          GH_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        run: |
          git config --global user.name 'github-actions'
          git config --global user.email 'github-actions@github.com'
          git add now_news.json
          git commit -m "ğŸ”„ ìë™ í¬ë¡¤ë§ ì—…ë°ì´íŠ¸: $(date +'%Y-%m-%d %H:%M:%S')" || echo "No changes to commit"
          git push https://x-access-token:${GH_TOKEN}@github.com/ric-grown/news-bot.git HEAD:main
