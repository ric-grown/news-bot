name: Blog News Crawler

permissions:
  contents: write

on:
  schedule:
    - cron: "0 */3 * * *"  # 3ì‹œê°„ë§ˆë‹¤ ì‹¤í–‰ (UTC ê¸°ì¤€)
  workflow_dispatch:  # ìˆ˜ë™ ì‹¤í–‰ë„ ê°€ëŠ¥í•˜ê²Œ ì„¤ì •

jobs:
  crawl_and_update:
    runs-on: ubuntu-latest
    
    steps:
      - name: ì €ì¥ì†Œ ì²´í¬ì•„ì›ƒ
        uses: actions/checkout@v4
        
      - name: Python ì„¤ì •
        uses: actions/setup-python@v4
        with:
          python-version: '3.x'
      
      - name: í•„ìˆ˜ íŒ¨í‚¤ì§€ ì„¤ì¹˜
        run: |
          pip install beautifulsoup4 requests notion-client selenium webdriver-manager openai

      
      - name: í¬ë¡¤ë§ ì‹¤í–‰
        run: |
          python news_crawler.py

      - name: ë³€ê²½ ì‚¬í•­ ì»¤ë°‹ ë° í‘¸ì‹œ
        env:
          GH_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        run: |
          git config --global user.name 'github-actions'
          git config --global user.email 'github-actions@github.com'
          git add now_news.json
          git commit -m "ğŸ”„ ìë™ í¬ë¡¤ë§ ì—…ë°ì´íŠ¸: $(date +'%Y-%m-%d %H:%M:%S')" || echo "No changes to commit"
          git push https://x-access-token:${GH_TOKEN}@github.com/ric-grown/news-bot.git HEAD:main
